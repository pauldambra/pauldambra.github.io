<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/images/icons/icon-152x152.png">
    <!-- theme-color defines the top bar color-->
    <meta name="theme-color" content="#575757"/>
    <meta http-equiv="X-Content-Security-Policy" content="default-src 'self'; script-src 'report-sample' 'self' https://app.posthog.com/static/array.js https://www.googletagmanager.com/gtag/js; style-src 'report-sample' 'self' https://fonts.googleapis.com; object-src 'none'; base-uri 'self'; connect-src 'self' https://app.posthog.com; font-src 'self'; frame-src 'self'; img-src 'self'; manifest-src 'self'; media-src 'self'; report-uri https://pauldambra.report-uri.com/r/d/csp/enforce; worker-src 'self';" />
    <!-- Add to home screen for Safari on iOS-->
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
    <meta name="apple-mobile-web-app-title" content="MiRaNo"/>
    <link rel="apple-touch-icon" href="/images/icons/icon-152x152.png"/>

    <!-- Add to home screen for Windows-->
    <meta name="msapplication-TileImage" content="/images/icons/icon-152x152.png"/>
    <meta name="msapplication-TileColor" content="#575757"/>

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Setting up an MVC3 website using built-in membership provider</title>
    <link rel="canonical" href="https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html" />
    <meta property="og:url"          content="https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html" />
    <meta property="og:type"         content="article" />
    <meta property="og:title"        content="Setting up an MVC3 website using built-in membership provider" />
    <meta property="og:description"  content="a blog about software engineering" />
    <meta property="og:image"        content="https://pauldambra.dev/images/cardboard.jpg" />
    <meta name="twitter:creator" content="@pauldambra" />
    <meta property="fb:app_id"       content="1029758320473951" />

    <meta name="viewport" content="width=device-width">
    <meta name="description" content="a blog about software engineering">
    <meta property="fb:pages" content="1029758320473951" />
    <link rel="alternate" type="application/rss+xml" title="Mindless Rambling Nonsense" href="https://pauldambra.dev/feed.xml">
    <link rel="shortcut icon" href="/favicon.ico" />

    <link rel="prefetch" href="/images/cardboard.jpg">

    <style>
      .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f0f3f3; }
.highlight .c { color: #0099FF; font-style: italic } /* Comment */
.highlight .err { color: #AA0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #006699; font-weight: bold } /* Keyword */
.highlight .o { color: #555555 } /* Operator */
.highlight .ch { color: #0099FF; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #0099FF; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #009999 } /* Comment.Preproc */
.highlight .cpf { color: #0099FF; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #0099FF; font-style: italic } /* Comment.Single */
.highlight .cs { color: #0099FF; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { background-color: #FFCCCC; border: 1px solid #CC0000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #003300; font-weight: bold } /* Generic.Heading */
.highlight .gi { background-color: #CCFFCC; border: 1px solid #00CC00 } /* Generic.Inserted */
.highlight .go { color: #AAAAAA } /* Generic.Output */
.highlight .gp { color: #000099; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #003300; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #99CC66 } /* Generic.Traceback */
.highlight .kc { color: #006699; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #006699; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #006699; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #006699 } /* Keyword.Pseudo */
.highlight .kr { color: #006699; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #007788; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #FF6600 } /* Literal.Number */
.highlight .s { color: #CC3300 } /* Literal.String */
.highlight .na { color: #330099 } /* Name.Attribute */
.highlight .nb { color: #336666 } /* Name.Builtin */
.highlight .nc { color: #00AA88; font-weight: bold } /* Name.Class */
.highlight .no { color: #336600 } /* Name.Constant */
.highlight .nd { color: #9999FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CC0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #CC00FF } /* Name.Function */
.highlight .nl { color: #9999FF } /* Name.Label */
.highlight .nn { color: #00CCFF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #330099; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #003333 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #FF6600 } /* Literal.Number.Bin */
.highlight .mf { color: #FF6600 } /* Literal.Number.Float */
.highlight .mh { color: #FF6600 } /* Literal.Number.Hex */
.highlight .mi { color: #FF6600 } /* Literal.Number.Integer */
.highlight .mo { color: #FF6600 } /* Literal.Number.Oct */
.highlight .sa { color: #CC3300 } /* Literal.String.Affix */
.highlight .sb { color: #CC3300 } /* Literal.String.Backtick */
.highlight .sc { color: #CC3300 } /* Literal.String.Char */
.highlight .dl { color: #CC3300 } /* Literal.String.Delimiter */
.highlight .sd { color: #CC3300; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #CC3300 } /* Literal.String.Double */
.highlight .se { color: #CC3300; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #CC3300 } /* Literal.String.Heredoc */
.highlight .si { color: #AA0000 } /* Literal.String.Interpol */
.highlight .sx { color: #CC3300 } /* Literal.String.Other */
.highlight .sr { color: #33AAAA } /* Literal.String.Regex */
.highlight .s1 { color: #CC3300 } /* Literal.String.Single */
.highlight .ss { color: #FFCC33 } /* Literal.String.Symbol */
.highlight .bp { color: #336666 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #CC00FF } /* Name.Function.Magic */
.highlight .vc { color: #003333 } /* Name.Variable.Class */
.highlight .vg { color: #003333 } /* Name.Variable.Global */
.highlight .vi { color: #003333 } /* Name.Variable.Instance */
.highlight .vm { color: #003333 } /* Name.Variable.Magic */
.highlight .il { color: #FF6600 } /* Literal.Number.Integer.Long */

      
      html { height: 100%; font-size: 20px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); }

html * { box-sizing: border-box; }

body { font-family: "Khula", sans-serif; font-size: 1em; min-height: 100%; display: flex; flex-direction: column; margin: 0; line-height: 1.42857143; }

main { background-color: #fff; padding: 10px 5px; /* flex: 1; would be enough but it looks bad in IE */ flex: 1 1 auto; width: 94%; margin: auto; }

h1 { font-size: 2em; }

h2 { font-size: 1.5em; }

h3 .post-metadata { font-size: 1.2em; }

h3.tag-list { font-size: 1.2em; }

hr { clear: both; }

p { word-wrap: break-word; }

a { color: #000; text-decoration: underline; }

a:visited { color: #000; }

a:hover { color: #000; text-decoration: underline; }

li { margin-left: 0.5em; }

.pagination { text-align: center; word-spacing: 0.75em; }

.pagination a { text-decoration: none; }

.pagination a:hover { text-decoration: underline; }

article header { display: flex; flex-direction: column; border-bottom: #000 solid 2px; background-color: #fff; color: #000; }

article header .heading { flex: 3 0 auto; }

article header .meta { flex: 1 0 auto; display: flex; flex-direction: row; }

@media (max-width: 450px) { article header .meta { flex-direction: column; } }

article header .meta .more-like-this { text-align: right; align-content: flex-end; flex: 3 0 auto; }

article header .meta .post-category { float: none; }

article header .meta .share-this { display: flex; align-self: flex-end; }

article header .meta .share-this a { margin-right: 5px; }

article header .meta .share-this img { width: 32px; height: 32px; }

article #title { line-height: 75px; padding-top: 10px; }

article h1 { -webkit-margin-after: 0; -webkit-margin-before: 5px; margin-bottom: 0; margin-top: 5px; }

blockquote { padding: 5px 10px; margin: 0 0 20px; border-left: 5px solid #eee; }

header { display: flex; flex-direction: column; background-color: #222; color: #fff; padding: 5px 15px 10px 15px; }

header nav, header .top { background-color: rgba(0, 0, 0, 0.3); box-shadow: 0 0 0.5em 0.5em rgba(0, 0, 0, 0.3); padding: 0.5em 1em; }

header nav a + a { margin-left: 1em; }

header .top { display: flex; flex-direction: row; }

@media (max-width: 550px) { header .top { flex-direction: column; } header .top .name { margin-top: 1em; } }

header .separator { flex-grow: 1; }

header.hero { background-image: url("/images/cardboard.jpg"); }

@media (max-width: 600px) { header.hero { background-position: -400px -23px; } }

@media (max-width: 778px) { header.hero { height: 370px; } }

@media (min-width: 778px) { header.hero { height: 437px; } }

@media (min-width: 984px) { header.hero { background-size: 100%; } }

@media (min-width: 1440px) { header.hero { height: 600px; } }

@media (max-height: 320px) { header.hero { height: 250px; } }

header.hero a { color: #fff; text-decoration: underline; }

header.hero a:visited { color: #fff; }

header.hero a:hover { color: #fff; text-decoration: underline; }

header a { color: #aaa; text-decoration: underline; }

header a:visited { color: #aaa; }

header a:hover { color: #aaa; text-decoration: underline; }

header .title a { text-decoration: none; }

@media (min-width: 550px) { header .title { font-size: 150%; font-weight: bold; } }

header .name { display: flex; align-items: flex-end; justify-content: flex-start; flex-direction: column; }

@media (max-width: 750px) { header .name p { justify-content: flex-end; } }

header .name .row { display: flex; align-items: center; }

header .name .row div { margin-right: 15px; }

header .name .row a { height: 32px; }

header p { margin: 0; word-wrap: break-word; }

@media screen and (max-width: 500px) { ul { padding: 0; } }

.excerpt h1 { overflow: hidden; text-overflow: ellipsis; }

.excerpt .series { display: none; }

.categories-list li { list-style: none; margin: 0.2em; }

.short { height: 100px !important; }

.tag-list { font-weight: normal; }

.tag-list li { list-style: none; margin: 0.2em; }

.tag-list .post-category { float: none; }

.tag-list h3 a { color: #000; text-decoration: none; }

.tag-list h3 a:visited { color: #000; }

.tag-list h3 a:hover { color: #000; text-decoration: underline; }

.tag-list a { color: #aaa; text-decoration: none; }

.tag-list a:visited { color: #aaa; }

.tag-list a:hover { color: #aaa; text-decoration: underline; }

.link-list .post-category { float: left; padding: 5px; }

.category-link { font-weight: normal; }

.category-link a { color: #000; text-decoration: none; }

.category-link a:visited { color: #000; }

.category-link a:hover { color: #000; text-decoration: underline; }

.post-metadata { color: #575757; display: inline-block; padding: 1px 3px; }

.post-metadata a { color: #575757; text-decoration: none; }

.post-metadata a:visited { color: #575757; }

.post-metadata a:hover { color: #575757; text-decoration: underline; }

.post-category { float: right; }

.post-category img { fill: #575757; width: 24px; height: 24px; display: inline-block; }

.post-item { -moz-transition: 0.25s; -ms-transition: 0.25s; -o-transition: 0.25s; -webkit-transition: 0.25s; margin-bottom: 20px; transition: 0.25s; display: flex; flex-direction: column; flex: 4 0 auto; }

.post-item:hover { background-color: rgba(245, 245, 245, 0.7); border-radius: 5px; }

.post-item .metadata .post-category { text-align: right; }

img { display: block; max-width: 1000px; vertical-align: middle; width: 100%; margin: auto; }

aside { border-left: 1px solid darkslateblue; color: darkslateblue; margin-bottom: 1em; margin-left: 2em; padding-left: 0.5em; }

aside.series { border-left: none; margin: 0 0 1.5em 0; }

aside.series h1 { font-size: 1em; }

aside.series .links { display: flex; }

aside.series .links .previous { text-align: left; flex: 1 0 auto; }

aside.series .links .next { text-align: right; flex: 1 0 auto; }

.posts { list-style-type: none; margin-bottom: 2em; padding: 0; }

.posts li { line-height: 1.75em; }

footer { padding: 5px 15px; margin: 0 auto; width: 100%; background-color: #000; color: #fff; min-height: 2em; overflow: hidden; height: 30px; }

footer a, footer a:visited, footer a:hover { color: #fff; line-height: 25px; vertical-align: bottom; text-decoration: none; }

footer a img, footer a:visited img, footer a:hover img { width: 25px; height: 25px; line-height: 25px; vertical-align: sub; text-decoration: none; display: inline; }

.paged-weeknotes a { text-decoration: none; }

.further-reading { margin-top: 60px; }

.further-reading a { text-decoration: none; }

.further-reading .article-tile { display: inline-block; width: 30%; margin-right: 1%; border: 1px solid #aaa; padding: 5px; min-height: 10em; text-overflow: ellipsis; vertical-align: top; position: relative; }

@media screen and (max-width: 425px) { .further-reading .article-tile { width: 100%; margin-bottom: 1%; } }

.further-reading .article-tile small { bottom: 5px; position: absolute; right: 5px; }

.highlight { overflow-x: scroll; }

    </style>
    <meta name="msvalidate.01" content="54691C3C7B863CEE60F0305D6EDFF7A8" />
    <meta name="google-site-verification" content="hLKEdujpXNQ9PSZWEcQkwxCgL2z1tWxVedeaUmttH7c" />
    <script>
  !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
  posthog.init('phc_DumQNjXoXRQpyaus5OM861c3BEYtwwKyzVTNmPs1XIt',{api_host:'https://app.posthog.com', _capture_performance: true, debug: true, autocapture: true, capture_pageview: true, disable_session_recording: false })
</script> 
  </head>
  <body>
    <header class="hero" role="banner">
	<div class="top">
		<div class="title">
			<a href="/">Mindless Rambling Nonsense</a>
		</div>
		<div class="separator"></div>
		<div class="name">
			<div class="row">
				<div>Paul D'Ambra</div>
					<a href="https://github.com/pauldambra" rel="noopener">
						<img src="/images/GitHub-Mark-Light-32px.png" alt="pauldambra on github" width="32" height="32">
					</a>
			</div>
			<div class="row">
				<div>Fangler</div>
					<a href="https://twitter.com/pauldambra" rel="noopener">
						<img src="/images/twitter-32.png" alt="pauldambra on twitter" width="32" height="32">
					</a>
			</div>
		</div>
	</div>
	<div class="separator"></div>
	<div class="bottom">
		<nav role="navigation">
			<a href="/">Blog Posts</a>
			<a href="/weeknotes.html">Week Notes</a>
		</nav>
	</div>
</header>

    <main role="main">
      

<script type="application/ld+json">
{  
   "@context":"http://schema.org",
   "@type":"BlogPosting",
   "headline":"Setting up an MVC3 website using built-in membership provider",
   "genre":"",
   "keywords":"",
   "wordCount":"1387",
   "url":"https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html",
   "datePublished":"2012-01-12",
   "author":{  
      "@type":"Person",
      "name":"Paul D'Ambra",
      "sameAs":[  
        "https://twitter.com/pauldambra",
        "https://github.com/pauldambra",
        "https://plus.google.com/u/0/+PaulDAmbraPlus"
      ]
   },
   "publisher":{  
"@type": "Organization",
    "name": "Paul D'Ambra",
    "sameAs": [
        "https://twitter.com/pauldambra",
        "https://github.com/pauldambra",
        "https://plus.google.com/u/0/+PaulDAmbraPlus"
    ],
    "logo": {
      "@type": "ImageObject",
      "contentUrl": "https://pauldambra.dev/images/logo.png",
        "url": "https://pauldambra.dev"
    }
   },
   "image":{  
      "@type":"ImageObject",
      "contentUrl":"https://pauldambra.dev/images/cardboard.jpg",
      "url":"https://pauldambra.dev",
      "height":"450",
      "width":"1000"
   },
   "mainEntityOfPage":{  
      "@type":"WebPage",
      "@id":"https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html"
   },
   "articleBody":"Oh  wait…  this  is  awful.  AWRUCHKA.  Right  dry  heaving  done  with.\n\nIt's  a  good  job  so  few  websites  want  to  authenticate  users  and  collect  data  on  them  otherwise  we'd  constantly  have  to  write  the  same  code  ove…  what's  that?  Oh  my!  Everyone  is  going  through  this.\n\n\n\nJesus  no  wonder  people  bang  on  about  RoR.  It  makes  this  easier  in  comparison\n\nAnyway  -  I'll  forget  how  to  do  this  before  I  have  to  do  it  again\n\nSo\n\n\n    fire  up  a  new  MVC3  web  application\n    Jump  into  nuget  and  Install-Package  System.Web.Providers \n    Sort  out  a  connection  string  for  SQL  CE\n    Add  a  key  to  make  sure  the  login  link  always  points  to  LogOn\n\n\nNow  my  web.config  looks  like  this  (edited  out  parts  I  haven't  touched  for  something  approximating  brevity)\n\n&lt;?xml  version=\"1.0\"  encoding=\"utf-8\"?&gt;\n&lt;!--\n    For  more  information  on  how  to  configure  your  ASP.NET  application,  please  visit\n    http://go.microsoft.com/fwlink/?LinkId=152368\n    --&gt;\n&lt;configuration&gt;\n    &lt;connectionStrings&gt;\n        &lt;add  name=\"users\"  connectionString=\"Data  Source=|DataDirectory|users.sdf;\"\n            providerName=\"System.Data.SqlServerCe.4.0\"/&gt;\n        &lt;/connectionStrings&gt;\n    &lt;appSettings&gt;\n        &lt;add  key=\"webpages:Version\"  value=\"1.0.0.0\"  /&gt;\n        &lt;add  key=\"ClientValidationEnabled\"  value=\"true\"  /&gt;\n        &lt;add  key=\"UnobtrusiveJavaScriptEnabled\"  value=\"true\"  /&gt;\n        &lt;add  key=\"loginUrl\"  value=\"~/Account/LogOn\"  /&gt;\n    &lt;/appSettings&gt;\n    &lt;system.web&gt;\n        &lt;authentication  mode=\"Forms\"&gt;\n            &lt;forms  loginUrl=\"~/Account/LogOn\"  timeout=\"2880\"  /&gt;\n        &lt;/authentication&gt;\n        &lt;membership  defaultProvider=\"DefaultMembershipProvider\"&gt;\n            &lt;providers&gt;\n                &lt;clear  /&gt;\n                &lt;add  name=\"DefaultMembershipProvider\"  type=\"System.Web.Providers.DefaultMembershipProvider,  System.Web.Providers,  Version=1.0.0.0,  Culture=neutral,  PublicKeyToken=31bf3856ad364e35\"  connectionStringName=\"users\"  enablePasswordRetrieval=\"false\"  enablePasswordReset=\"true\"  requiresQuestionAndAnswer=\"false\"  requiresUniqueEmail=\"false\"  maxInvalidPasswordAttempts=\"5\"  minRequiredPasswordLength=\"6\"  minRequiredNonalphanumericCharacters=\"0\"  passwordAttemptWindow=\"10\"  applicationName=\"/\"  /&gt;\n            &lt;/providers&gt;\n        &lt;/membership&gt;\n        &lt;profile  defaultProvider=\"DefaultProfileProvider\"&gt;\n            &lt;providers&gt;\n                &lt;clear  /&gt;\n                &lt;add  name=\"DefaultProfileProvider\"  type=\"System.Web.Providers.DefaultProfileProvider,  System.Web.Providers,  Version=1.0.0.0,  Culture=neutral,  PublicKeyToken=31bf3856ad364e35\"  connectionStringName=\"users\"  applicationName=\"/\"  /&gt;\n            &lt;/providers&gt;\n        &lt;/profile&gt;\n        &lt;roleManager  enabled=\"false\"  defaultProvider=\"DefaultRoleProvider\"&gt;\n            &lt;providers&gt;\n                &lt;clear  /&gt;\n                &lt;add  name=\"AspNetWindowsTokenRoleProvider\"  type=\"System.Web.Security.WindowsTokenRoleProvider\"  applicationName=\"/\"  /&gt;\n                &lt;add  name=\"DefaultRoleProvider\"  type=\"System.Web.Providers.DefaultRoleProvider,  System.Web.Providers,  Version=1.0.0.0,  Culture=neutral,  PublicKeyToken=31bf3856ad364e35\"  connectionStringName=\"users\"  applicationName=\"/\"  /&gt;\n            &lt;/providers&gt;\n        &lt;/roleManager&gt;\n        &lt;sessionState  mode=\"InProc\"  customProvider=\"DefaultSessionProvider\"&gt;\n            &lt;providers&gt;\n                &lt;add  name=\"DefaultSessionProvider\"  type=\"System.Web.Providers.DefaultSessionStateProvider,  System.Web.Providers,  Version=1.0.0.0,  Culture=neutral,  PublicKeyToken=31bf3856ad364e35\"  connectionStringName=\"DefaultConnection\"  applicationName=\"/\"  /&gt;\n            &lt;/providers&gt;\n        &lt;/sessionState&gt;\n    &lt;/system.web&gt;\n&lt;/configuration&gt;\n\n\nNow  start  a  debug  session  for  the  web  app.  Click  logon.  Click  Register.  Fill  in  the  form.  Register.  Click  Logoff  and  stop  the  debug  session  in  Visual  Studio\n\nYou  can  see  the  new  SQL  CE  database  and  have  a  look  at  the  schema.  The  Memberships  and  Users  tables  have  a  new  row.  The  new  user.\n\n\n\n\n\n\n\n\n\nHurrah  -  all  the  information  you'll  ever  need  is  collected.\n\nWhat?!  You  want  to  know  more  than  name  and  email.  Now  that's  a  turn  up  for  the  books.\n\nIt  turns  out  you  can  store  key-value  pairs  in  the  profiles  table.  I  think  that  anyone  that  wrote  ASP  dot  Net  websites  will  be  old-hand  at  this  but  I've  never  had  to  do  that  or  this…\n\nWhile  you  can  do  magic  up  a  key-value  pair  whenever  you  feel  the  need  to  in  your  code  it's  probably  better  to  use  one  of  these  new  fangled  Class  thing-a-ma-bobs\n\n\nusing  System;\nusing  System.Web.Profile;\n\nnamespace  AcrHack.Models\n{\n        public  class  CustomProfile  :  ProfileBase\n        {\n                //magic  string\n                public  static  string  ADDRESS  =  \"address\";\n\n                public  string  Address\n                {\n                        get  {  return  this[ADDRESS]  as  String;  }\n                        set  {  this[ADDRESS]  =  value;  }\n                }\n        }\n}\n\n\nNow  a  quick  edit  to  the  web  config  above  so  that  the  providers  opening  tag  becomes\n\n&lt;profile  defaultprovider=\"DefaultProfileProvider\"  inherits=\"AcrHack.Models.CustomProfile\"/&gt;\n\n\nwhich  makes  the  Profile  Provider  aware  of  the  new  Profile  class\n\nNext  step  is  to  find  the  RegisterModel  (this  could  be  the  CreateModel  or  some  other  model)  and  add  an  Address  field\n\npublic  class  RegisterModel\n{\n        [Required]\n        [Display(Name  =  \"User  name\")]\n        public  string  UserName  {  get;  set;  }\n\n        [Required]\n        [DataType(DataType.EmailAddress)]\n        [Display(Name  =  \"Email  address\")]\n        public  string  Email  {  get;  set;  }\n\n        [Required]\n        [StringLength(100,  ErrorMessage  =  \"The  {0}  must  be  at  least  {2}  characters  long.\",  MinimumLength  =  6)]\n        [DataType(DataType.Password)]\n        [Display(Name  =  \"Password\")]\n        public  string  Password  {  get;  set;  }\n\n        [DataType(DataType.Password)]\n        [Display(Name  =  \"Confirm  password\")]\n        [Compare(\"Password\",  ErrorMessage  =  \"The  password  and  confirmation  password  do  not  match.\")]\n        public  string  ConfirmPassword  {  get;  set;  }\n        \n        //Added  Address  field\n        [Required]\n        public  string  Address  {  get;  set;  }\n}\n\n\nand  edit  the  Register  method  in  the  controller\n\n\n[HttpPost]\npublic  ActionResult  Register(RegisterModel  model)\n{\n        if  (ModelState.IsValid)\n        {\n                //  Attempt  to  register  the  user\n                MembershipCreateStatus  createStatus;\n                Membership.CreateUser(model.UserName,  model.Password,  model.Email,  null,  null,  true,  null,  out  createStatus);\n\n                if  (createStatus  ==  MembershipCreateStatus.Success)\n                {\n                        FormsAuthentication.SetAuthCookie(model.UserName,  false);\n                        //Changes  here\n                        //Create  loads  or  creates  a  profile  based  on  searching  for  username\n                        var  userProfile  =  ProfileBase.Create(model.UserName)  as  CustomProfile;\n                        userProfile.Address  =  model.Address;\n                        userProfile.Save();\n                        //End  of  changes\n                        return  RedirectToAction(\"Index\",  \"Home\");\n                }\n                else\n                {\n                        ModelState.AddModelError(\"\",  ErrorCodeToString(createStatus));\n                }\n        }\n\n        //  If  we  got  this  far,  something  failed,  redisplay  form\n        return  View(model);\n}\n\n\nand  finally  edit  the  view  to  add  an  editor  field  for  the  new  property.  (I'll  leave  that  as  an  exercise  for  the  reader)\n\nNow  we  can  go  back  to  the  Register  page\n\n\n\nRegister  and  then  have  a  look  in  the  profile  table.\n\n\n\nTa  da!\n\nSo  there's  a  mechanism  for  extending  the  default  profile.\n\nHonestly,  it  feels  messy  and  since  at  this  point  if  there's  a  need  for  any  data  access  layer  then  since  there'll  be  a  link  on  user  name  or  user  id  anyway  it's  likely  a  better  idea  to  have  the  additional  data  in  the  DAL  and  fangle  the  authentication  and  user  models  together  in  a  ViewModel.\n\nHaving  gone  away  and  checked  some  code  committed  on  another  project  by  the  lovely  OrangeTentacle  that's  what  he's  done.  So  having  figured  it  out  for  myself  I'll  probably  go  and  crib  off  that  much  tidier  code\n\nAdditional  Reading:\n\nSimple.Web.Providers  announcement\n\n"
}
</script>
<article>
<header>
	<div class="heading">
		<div class="date">
			Thu Jan 12 2012
		</div>
		<h1 class="title">Setting up an MVC3 website using built-in membership provider</h1>
	</div>
	<div class="meta">
		<div class="share-this">
			<a id="facebook-share-link" 
			   class="social-share" 
			   target="_blank"
			   rel="noopener"
			   href="https://www.facebook.com/dialog/share?app_id=305449093152216&href=https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html">
				<img src="/images/facebook-black-32.png" alt="share on facebook" width="32" height="32">
			</a>
			<a id="twitter-share-link"
			   class="social-share" 
			   target="_blank"
			   rel="noopener"
			   href="https://twitter.com/intent/tweet?text=Setting+up+an+MVC3+website+using+built-in+membership+provider&via=pauldambra&url=https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html">
				<img src="/images/twitter-black-32.png" alt="share on twitter" width="32" height="32">
			</a>
		</div>
		<div class="more-like-this">
			<a class="post-metadata post-category"
				href="/categories.html#rant">
				in: rant
			</a>
			<div>
				
	<span class="post-category">
		<img src="/images/tag.svg" alt="tag-icon"/>
		<a class="post-metadata"
			href="/tags.html#mvc">
			mvc
		</a>
	</span>

	<span class="post-category">
		<img src="/images/tag.svg" alt="tag-icon"/>
		<a class="post-metadata"
			href="/tags.html#visual-studio">
			visual-studio
		</a>
	</span>

	<span class="post-category">
		<img src="/images/tag.svg" alt="tag-icon"/>
		<a class="post-metadata"
			href="/tags.html#membership-provider">
			membership-provider
		</a>
	</span>

			</div>
		</div>
	</div>
</header>
	<div class="post">
		<p>Oh wait… this is awful. AWRUCHKA. Right dry heaving done with.</p>

<p>It's a good job so few websites want to authenticate users and collect data on them otherwise we'd constantly have to write the same code ove… what's that? Oh my! Everyone is going through this.</p>

<!--more-->

<p>Jesus no wonder people bang on about RoR. It makes this <em>easier</em> in comparison</p>

<p>Anyway - I'll forget how to do this before I have to do it again</p>

<p>So</p>

<ul>
  <li>fire up a new MVC3 web application</li>
  <li>Jump into nuget and Install-Package System.Web.Providers </li>
  <li>Sort out a connection string for SQL CE</li>
  <li>Add a key to make sure the login link always points to <code class="language-plaintext highlighter-rouge">LogOn</code></li>
</ul>

<p>Now my <code class="language-plaintext highlighter-rouge">web.config</code> looks like this (edited out parts I haven't touched for something approximating brevity)</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="c">&lt;!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=152368
  --&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;connectionStrings&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"users"</span> <span class="na">connectionString=</span><span class="s">"Data Source=|DataDirectory|users.sdf;"</span>
      <span class="na">providerName=</span><span class="s">"System.Data.SqlServerCe.4.0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/connectionStrings&gt;</span>
  <span class="nt">&lt;appSettings&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">"webpages:Version"</span> <span class="na">value=</span><span class="s">"1.0.0.0"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">"ClientValidationEnabled"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">"UnobtrusiveJavaScriptEnabled"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">"loginUrl"</span> <span class="na">value=</span><span class="s">"~/Account/LogOn"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/appSettings&gt;</span>
  <span class="nt">&lt;system.web&gt;</span>
    <span class="nt">&lt;authentication</span> <span class="na">mode=</span><span class="s">"Forms"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;forms</span> <span class="na">loginUrl=</span><span class="s">"~/Account/LogOn"</span> <span class="na">timeout=</span><span class="s">"2880"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/authentication&gt;</span>
    <span class="nt">&lt;membership</span> <span class="na">defaultProvider=</span><span class="s">"DefaultMembershipProvider"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;providers&gt;</span>
        <span class="nt">&lt;clear</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"DefaultMembershipProvider"</span> <span class="na">type=</span><span class="s">"System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"</span> <span class="na">connectionStringName=</span><span class="s">"users"</span> <span class="na">enablePasswordRetrieval=</span><span class="s">"false"</span> <span class="na">enablePasswordReset=</span><span class="s">"true"</span> <span class="na">requiresQuestionAndAnswer=</span><span class="s">"false"</span> <span class="na">requiresUniqueEmail=</span><span class="s">"false"</span> <span class="na">maxInvalidPasswordAttempts=</span><span class="s">"5"</span> <span class="na">minRequiredPasswordLength=</span><span class="s">"6"</span> <span class="na">minRequiredNonalphanumericCharacters=</span><span class="s">"0"</span> <span class="na">passwordAttemptWindow=</span><span class="s">"10"</span> <span class="na">applicationName=</span><span class="s">"/"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/providers&gt;</span>
    <span class="nt">&lt;/membership&gt;</span>
    <span class="nt">&lt;profile</span> <span class="na">defaultProvider=</span><span class="s">"DefaultProfileProvider"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;providers&gt;</span>
        <span class="nt">&lt;clear</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"DefaultProfileProvider"</span> <span class="na">type=</span><span class="s">"System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"</span> <span class="na">connectionStringName=</span><span class="s">"users"</span> <span class="na">applicationName=</span><span class="s">"/"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/providers&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
    <span class="nt">&lt;roleManager</span> <span class="na">enabled=</span><span class="s">"false"</span> <span class="na">defaultProvider=</span><span class="s">"DefaultRoleProvider"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;providers&gt;</span>
        <span class="nt">&lt;clear</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"AspNetWindowsTokenRoleProvider"</span> <span class="na">type=</span><span class="s">"System.Web.Security.WindowsTokenRoleProvider"</span> <span class="na">applicationName=</span><span class="s">"/"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"DefaultRoleProvider"</span> <span class="na">type=</span><span class="s">"System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"</span> <span class="na">connectionStringName=</span><span class="s">"users"</span> <span class="na">applicationName=</span><span class="s">"/"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/providers&gt;</span>
    <span class="nt">&lt;/roleManager&gt;</span>
    <span class="nt">&lt;sessionState</span> <span class="na">mode=</span><span class="s">"InProc"</span> <span class="na">customProvider=</span><span class="s">"DefaultSessionProvider"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;providers&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"DefaultSessionProvider"</span> <span class="na">type=</span><span class="s">"System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"</span> <span class="na">connectionStringName=</span><span class="s">"DefaultConnection"</span> <span class="na">applicationName=</span><span class="s">"/"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/providers&gt;</span>
    <span class="nt">&lt;/sessionState&gt;</span>
  <span class="nt">&lt;/system.web&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<p>Now start a debug session for the web app. Click logon. Click Register. Fill in the form. Register. Click Logoff and stop the debug session in Visual Studio</p>

<p>You can see the new SQL CE database and have a look at the schema. The Memberships and Users tables have a new row. The new user.</p>

<p><img src="http://4.bp.blogspot.com/-w1VYrhrRydw/Tw7Aak9b3tI/AAAAAAAAAWw/dQllCHJ7Qjo/s1600/new-sdf-file.PNG" alt="ssms screenshots" loading="lazy" /></p>

<p><img src="http://2.bp.blogspot.com/-y4bJjVXY8js/Tw7AcoHn8lI/AAAAAAAAAW4/hnLZO6ShvaQ/s1600/schema.PNG" alt="ssms screenshots" loading="lazy" /></p>

<p><img src="http://2.bp.blogspot.com/-tkP3-E66KgQ/Tw7Ad9z8n1I/AAAAAAAAAXA/Vcu-JkjCZrc/s1600/memberships.PNG" alt="ssms screenshots" loading="lazy" /></p>

<p><img src="http://1.bp.blogspot.com/-Q83_Po9kXN4/Tw7AfVHsCcI/AAAAAAAAAXI/AvdnqwrMTvA/s1600/users-table.PNG" alt="ssms screenshots" loading="lazy" /></p>

<p>Hurrah - all the information you'll ever need is collected.</p>

<p>What?! You want to know more than name and email. Now <em>that's</em> a turn up for the books.</p>

<p>It turns out you can store key-value pairs in the profiles table. I think that anyone that wrote ASP dot Net websites will be old-hand at this but I've never had to do that or this…</p>

<p>While you can do magic up a key-value pair whenever you feel the need to in your code it's probably better to use one of these new fangled Class thing-a-ma-bobs</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Web.Profile</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">AcrHack.Models</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">CustomProfile</span> <span class="p">:</span> <span class="n">ProfileBase</span>
    <span class="p">{</span>
        <span class="c1">//magic string</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">ADDRESS</span> <span class="p">=</span> <span class="s">"address"</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="n">Address</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="n">ADDRESS</span><span class="p">]</span> <span class="k">as</span> <span class="n">String</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span> <span class="p">{</span> <span class="k">this</span><span class="p">[</span><span class="n">ADDRESS</span><span class="p">]</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now a quick edit to the web config above so that the providers opening tag becomes</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;profile</span> <span class="na">defaultprovider=</span><span class="s">"DefaultProfileProvider"</span> <span class="na">inherits=</span><span class="s">"AcrHack.Models.CustomProfile"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>which makes the Profile Provider aware of the new Profile class</p>

<p>Next step is to find the <code class="language-plaintext highlighter-rouge">RegisterModel</code> (this could be the <code class="language-plaintext highlighter-rouge">CreateModel</code> or some other model) and add an Address field</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">RegisterModel</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">Display</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"User name"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">UserName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">DataType</span><span class="p">(</span><span class="n">DataType</span><span class="p">.</span><span class="n">EmailAddress</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">Display</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Email address"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Email</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="n">ErrorMessage</span> <span class="p">=</span> <span class="s">"The {0} must be at least {2} characters long."</span><span class="p">,</span> <span class="n">MinimumLength</span> <span class="p">=</span> <span class="m">6</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">DataType</span><span class="p">(</span><span class="n">DataType</span><span class="p">.</span><span class="n">Password</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">Display</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Password"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Password</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="p">[</span><span class="nf">DataType</span><span class="p">(</span><span class="n">DataType</span><span class="p">.</span><span class="n">Password</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">Display</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Confirm password"</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">Compare</span><span class="p">(</span><span class="s">"Password"</span><span class="p">,</span> <span class="n">ErrorMessage</span> <span class="p">=</span> <span class="s">"The password and confirmation password do not match."</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">ConfirmPassword</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    
    <span class="c1">//Added Address field</span>
    <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Address</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>and edit the Register method in the controller</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
<span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Register</span><span class="p">(</span><span class="n">RegisterModel</span> <span class="n">model</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Attempt to register the user</span>
        <span class="n">MembershipCreateStatus</span> <span class="n">createStatus</span><span class="p">;</span>
        <span class="n">Membership</span><span class="p">.</span><span class="nf">CreateUser</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">out</span> <span class="n">createStatus</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">createStatus</span> <span class="p">==</span> <span class="n">MembershipCreateStatus</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">FormsAuthentication</span><span class="p">.</span><span class="nf">SetAuthCookie</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
            <span class="c1">//Changes here</span>
            <span class="c1">//Create loads or creates a profile based on searching for username</span>
            <span class="kt">var</span> <span class="n">userProfile</span> <span class="p">=</span> <span class="n">ProfileBase</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">UserName</span><span class="p">)</span> <span class="k">as</span> <span class="n">CustomProfile</span><span class="p">;</span>
            <span class="n">userProfile</span><span class="p">.</span><span class="n">Address</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">Address</span><span class="p">;</span>
            <span class="n">userProfile</span><span class="p">.</span><span class="nf">Save</span><span class="p">();</span>
            <span class="c1">//End of changes</span>
            <span class="k">return</span> <span class="nf">RedirectToAction</span><span class="p">(</span><span class="s">"Index"</span><span class="p">,</span> <span class="s">"Home"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">ModelState</span><span class="p">.</span><span class="nf">AddModelError</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="nf">ErrorCodeToString</span><span class="p">(</span><span class="n">createStatus</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// If we got this far, something failed, redisplay form</span>
    <span class="k">return</span> <span class="nf">View</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><em>and</em> finally edit the view to add an editor field for the new property. (I'll leave that as an exercise for the reader)</p>

<p>Now we can go back to the Register page</p>

<p><img src="http://2.bp.blogspot.com/-TZWnNTSKRvY/Tw7HgUSY_jI/AAAAAAAAAXQ/zFssEVG51_4/s1600/new+registration+form+bit.PNG" alt="register page" loading="lazy" /></p>

<p>Register and then have a look in the profile table.</p>

<p><img src="http://4.bp.blogspot.com/-oKVRwA7UVxM/Tw7Hnkm1AfI/AAAAAAAAAXY/hHvXOXRF3ug/s1600/persistedproperty.PNG" alt="profile table" loading="lazy" /></p>

<p>Ta da!</p>

<p>So there's a mechanism for extending the default profile.</p>

<p>Honestly, it feels messy and since at this point if there's a need for any data access layer then since there'll be a link on user name or user id anyway it's likely a better idea to have the additional data in the DAL and fangle the authentication and user models together in a <code class="language-plaintext highlighter-rouge">ViewModel</code>.
<!--alex ignore he-she her-him--->
Having gone away and checked some code committed on another project by the lovely <a href="http://www.orangetentacle.co.uk/">OrangeTentacle</a> that's what he's done. So having figured it out for myself I'll probably go and crib off that much tidier code</p>

<p>Additional Reading:</p>

<p><a href="http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx"><code class="language-plaintext highlighter-rouge">Simple.Web.Providers</code> announcement</a></p>


	</div>
	<div class="further-reading">

  

  
    <h1>More like this...</h1>
      
          <a href="/2018/01/direction.html">
  <div class="article-tile">
      <h3>
        Is where we're going where we're going
      </h3>
      <small>
        29 Jan 2018
      </small>
  </div>
</a>
      
          <a href="/2013/11/astronomical-database-identfier.html">
  <div class="article-tile">
      <h3>
        Astronomical Database Identfier
      </h3>
      <small>
        22 Nov 2013
      </small>
  </div>
</a>
      
          <a href="/2009/10/bing-is-not-search-engine.html">
  <div class="article-tile">
      <h3>
        Bing is not a search engine
      </h3>
      <small>
        30 Oct 2009
      </small>
  </div>
</a>
      
   
</div>

</article>
    </div>
    <footer>
	<div>
		<a href="https://pauldambra.dev/feed.xml">
			<img src="/images/rss.svg" alt="the rss feed">
			Subscribe to RSS feed
		</a>
	</div>
</footer>

    
    <script>
      var tsl = document.getElementById('twitter-share-link')
      tsl.addEventListener('click', function() {
        ga('send', {
          hitType: 'social',
          socialNetwork: 'twitter',
          socialAction: 'tweet',
          socialTarget: "https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html"
        });
      });

      var fsl = document.getElementById('facebook-share-link')
      fsl.addEventListener('click', function() {
        ga('send', {
          hitType: 'social',
          socialNetwork: 'facebook',
          socialAction: 'share',
          socialTarget: "https://pauldambra.dev/2012/01/setting-up-mvc3-website-using-built-in.html"
        });
      });
    </script>
    

    <script defer src="/register-service-worker.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Khula&display=swap" rel="stylesheet">

  </body>
</html>
